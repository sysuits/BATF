# Bayesian augmented tensor factorization
MATLAB code for paper *Missing traffic data imputation and pattern discovery with a Bayesian augmented tensor factorization model* by Xinyu Chen, Zhaocheng He, Yixian Chen, Yuhuan Lu and Jiawei Wang, 2019. Transportation Research Part C: Emerging Technologies, 104: 66-77. [[**preprint**](https://xinychen.github.io/paper/BATF.pdf)] [[**slide**](https://doi.org/10.5281/zenodo.2632552)]

## Project structure

### Code of BATF

- `BATF_VB.m`: The main code file. Implements variational inference for BATF.
- `Test_BATF.m`: The testing file. You can find a testing example here.

### Utility functions

- `ms_scenario.m`: Generate incomplete tensor with different missing scenarios.
- `cp_combination.m`: A function for the CP combination over factor matrices.
- `khatrirao_fast.m`: A fast Khatri-Rao product function.
- `kr.m`:  A Kronecker product function.
- `mat2ten.m`: A tensor folding function.
- `ten2mat.m`: A tensor unfolding function.
- `vec_combination.m`: A function for summing up the bias vectors to a 3-dimensional tensor.
- `safelog.m`: A safe logarithm function inspired by the work of [BCPF](https://github.com/qbzhao/BCPF).

### Experimental dataset

- `tensor.mat`:  The original speed data. Organized as a third-order tensor (road segment × day × time interval, with a size of 214 × 61 × 144).  There are about 1.29% missing values in the raw data set.
- `random_tensor.mat`: A synthesis random tensor. Used for generating random missing tensor.
- `random_matrix.mat`: A synthesis random matrix. Used for generating fiber missing tensor.

## Usage

BATF can be run as follows:

```matlab
[model] = BATF_VB(dense_tensor,sparse_tensor,'CP_rank',low_rank,'maxiter',max_iteration);
```

**Required Arguments**:

- `dense_tensor`: The original data tensor.
- `sparse_tensor`: The incomplete tensor generated by `ms_scenario.m` function.

**Optional Arguments**:

- `'CP_rank'`: The low rank of CP factorization.
- `'maxiter'`: The maximum number of iterations for implementing variational inference.

## Citation

If you find the project useful for your publication, please consider citing our publicly available dataset and paper:

- Urban Traffic Speed Dataset of Guangzhou, China (Available at [https://doi.org/10.5281/zenodo.1205229](https://doi.org/10.5281/zenodo.1205229))

  ```tex
  @Misc{XinyuChen2018Urban,
    author    = {{Xinyu Chen} and {Yixian Chen} and {Zhaocheng He}},
    title     = {Urban Traffic Speed Dataset of Guangzhou, China},
    year      = {2018},
    doi       = {10.5281/zenodo.1205228},
    keywords  = {intelligent transportation systems, urban traffic speed data, urban traffic data analytics, missing data imputation, short-term traffic prediction, traffic pattern discovery},
    publisher = {Zenodo},
  }
  ```

- Missing traffic data imputation and pattern discovery with a Bayesian augmented tensor factorization model (Available at [https://doi.org/10.1016/j.trc.2019.03.003](https://doi.org/10.1016/j.trc.2019.03.003))

  ```tex
  @Article{Chen2019Missing,
    author    = {Xinyu Chen and Zhaocheng He and Yixian Chen and Yuhuan Lu and Jiawei Wang},
    title     = {Missing traffic data imputation and pattern discovery with a Bayesian augmented tensor factorization model},
    journal   = {Transportation Research Part C: Emerging Technologies},
    year      = {2019},
    volume    = {104},
    pages     = {66--77},
    month     = {jul},
    doi       = {10.1016/j.trc.2019.03.003},
    publisher = {Elsevier {BV}},
  }
  ```

## License

The MIT License (MIT)
